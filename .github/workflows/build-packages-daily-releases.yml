---
name: Trigger workflow build-packages for different releases

on:
  workflow_dispatch:
  schedule:
    - cron: '0 3 * * *'

permissions:
  actions: read
  id-token: write
  contents: write

jobs:
  call-build-packages-auth-49:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'authoritative'
      ref: rel/auth-4.9.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-auth-48:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'authoritative'
      ref: rel/auth-4.9.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-auth-47:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'authoritative'
      ref: rel/auth-4.9.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-rec-52:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'recursor'
      ref: rel/rec-5.2.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-rec-51:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'recursor'
      ref: rel/rec-5.1.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-rec-50:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'recursor'
      ref: rel/rec-5.0.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-dnsdist-19:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'dnsdist'
      ref: rel/dnsdist-1.9.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}

  call-build-packages-dnsdist-18:
    if: ${{ vars.SCHEDULED_PACKAGES_DAILY }}
    uses: PowerDNS/pdns/.github/workflows/build-packages.yml@master
    with:
      is_release: 'NO'
      product: 'dnsdist'
      ref: rel/dnsdist-1.9.x
    secrets:
      DOWNLOADS_AUTOBUILT_SECRET: ${{ secrets.DOWNLOADS_AUTOBUILT_SECRET }}
      DOWNLOADS_AUTOBUILT_RSYNCTARGET: ${{ secrets.DOWNLOADS_AUTOBUILT_RSYNCTARGET }}
      DOWNLOADS_AUTOBUILT_HOSTKEY: ${{ secrets.DOWNLOADS_AUTOBUILT_HOSTKEY }}
